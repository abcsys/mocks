apiVersion: mock.digi.dev/v1
kind: Room
metadata:
  name: {{ .Values.name }}
spec:
  control:
    brightness:
      intent: 1
    mode:
      intent: work
  ingress:
    device_energy:
      sources: [ kind:any@energy ]
      flow: "sort -r event_ts | head"
      flow_agg: "select sum(watt) as watt"
      eoio: false
  egress:
    energy:
      flow: "watt | cut watt,event_ts"
    occupancy:
      flow: |-
        desk_occupancy |
        cut desk_occupancy,event_ts |
        rename occupancy := desk_occupancy
